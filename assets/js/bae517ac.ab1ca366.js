"use strict";(self.webpackChunkflowtide=self.webpackChunkflowtide||[]).push([[7594],{4852:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"operators/aggregate","title":"Aggregate Operator","description":"The Aggregate Operator implements the Substrait Aggregate Relation.","source":"@site/docs/operators/aggregate.md","sourceDirName":"operators","slug":"/operators/aggregate","permalink":"/flowtide/docs/operators/aggregate","draft":false,"unlisted":false,"editUrl":"https://github.com/koralium/flowtide/tree/main/docs/docs/operators/aggregate.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Set Operator","permalink":"/flowtide/docs/operators/set"},"next":{"title":"Iteration Operator","permalink":"/flowtide/docs/operators/iteration"}}');var n=r(4848),a=r(8453);const o={sidebar_position:6},i="Aggregate Operator",l={},d=[{value:"Metrics",id:"metrics",level:2}];function h(e){const t={a:"a",admonition:"admonition",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"aggregate-operator",children:"Aggregate Operator"})}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.em,{children:"Aggregate Operator"})," implements the ",(0,n.jsx)(t.em,{children:"Substrait"})," ",(0,n.jsx)(t.a,{href:"https://substrait.io/relations/logical_relations/#aggregate-operation",children:"Aggregate Relation"}),".\nThis handles computation of ",(0,n.jsx)(t.em,{children:"aggregate functions"})," and groupings."]}),"\n",(0,n.jsxs)(t.p,{children:["At this time not all features on the ",(0,n.jsx)(t.em,{children:"aggregate relation"})," is supported, and some features are limited."]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Measures does not support filters yet, such as SUM(c) FILTER(WHERE...)"}),"\n",(0,n.jsx)(t.li,{children:"When doing groupings, such as 'GROUP BY', only one grouping set is supported (you can group multiple columns in a single grouping set)."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The operator is stateful and uses one persistent B+ tree to store all the measures state values, and one temporary B+ tree to keep track of\nwhich keys have been modified."}),"\n",(0,n.jsx)(t.p,{children:"New values are only sent out on watermark updates, this is done to reduce the amount of traffic on the stream, and allow the state of each measure\nto be updated in-place, to reduce memory allocation."}),"\n",(0,n.jsx)(t.h2,{id:"metrics",children:"Metrics"}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.em,{children:"Aggregate Operator"})," has the following metrics:"]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Metric Name"}),(0,n.jsx)(t.th,{children:"Type"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"busy"}),(0,n.jsx)(t.td,{children:"Gauge"}),(0,n.jsx)(t.td,{children:"Value 0-1 on how busy the operator is."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"backpressure"}),(0,n.jsx)(t.td,{children:"Gauge"}),(0,n.jsx)(t.td,{children:"Value 0-1 on how much backpressure the operator has."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"health"}),(0,n.jsx)(t.td,{children:"Gauge"}),(0,n.jsx)(t.td,{children:"Value 0 or 1, if the operator is healthy or not."})]})]})]}),"\n",(0,n.jsx)(t.admonition,{type:"info",children:(0,n.jsx)(t.p,{children:"At this point, an aggregate operator will never be unhealthy.\nIf there is a failure against the state, the stream will instead restart."})})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},8453:(e,t,r)=>{r.d(t,{R:()=>o,x:()=>i});var s=r(6540);const n={},a=s.createContext(n);function o(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);