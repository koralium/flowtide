"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9671],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>h});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=n.createContext({}),d=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=d(e.components);return n.createElement(o.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=d(a),m=r,h=c["".concat(o,".").concat(m)]||c[m]||p[m]||l;return a?n.createElement(h,i(i({ref:t},u),{},{components:a})):n.createElement(h,i({ref:t},u))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=m;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s[c]="string"==typeof e?e:r,i[1]=s;for(var d=2;d<l;d++)i[d]=a[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},9881:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>d});var n=a(7462),r=(a(7294),a(3905));const l={sidebar_position:1},i="Getting started",s={unversionedId:"intro",id:"intro",title:"Getting started",description:"To get started with Flowtide, the easiest way is to create a new C# project. This guide will show an example with SQL Server, but you can change",source:"@site/docs/intro.md",sourceDirName:".",slug:"/intro",permalink:"/flowtide/docs/intro",draft:!1,editUrl:"https://github.com/koralium/flowtide/tree/main/docs/docs/intro.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",next:{title:"State Persistence",permalink:"/flowtide/docs/statepersistence"}},o={},d=[{value:"Creating a plan",id:"creating-a-plan",level:2},{value:"Setting up a read and write factory",id:"setting-up-a-read-and-write-factory",level:2},{value:"Running the stream",id:"running-the-stream",level:2},{value:"Persistent storage",id:"persistent-storage",level:3},{value:"Adding the UI",id:"adding-the-ui",level:2},{value:"Full example",id:"full-example",level:2}],u={toc:d},c="wrapper";function p(e){let{components:t,...a}=e;return(0,r.kt)(c,(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"getting-started"},"Getting started"),(0,r.kt)("p",null,"To get started with Flowtide, the easiest way is to create a new C# project. This guide will show an example with SQL Server, but you can change\nto another connector as well."),(0,r.kt)("p",null,"Create a minimal API AspNetCore application and install the following nuget package:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"FlowtideDotNet.AspNetCore"),(0,r.kt)("li",{parentName:"ul"},"FlowtideDotNet.SqlServer")),(0,r.kt)("h2",{id:"creating-a-plan"},"Creating a plan"),(0,r.kt)("p",null,"The first step is to create an execution plan, this can be be done with any substrait plan creator.\nBut it is also possible to do it with SQL inside flowtide. This tutorial will only show how to create a plan with SQL."),(0,r.kt)("p",null,"Add the following to your ",(0,r.kt)("em",{parentName:"p"},"Program.cs"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},'\nvar sqlBuilder = new SqlPlanBuilder();\n\nsqlBuilder.Sql(@"\nCREATE TABLE {sqlserver database name}.{schema name}.{tablename} (\n  val any\n);\n\nCREATE TABLE {sqlserver database name}.{schema name}.{othertablename} (\n  val any\n);\n\nINSERT INTO {sqlserver database name}.{schema name}.{destinationname}\nSELECT t.val FROM {sqlserver database name}.{schema name}.{tablename} t\nLEFT JOIN {sqlserver database name}.{schema name}.{othertablename} o\nON t.val = o.val\nWHERE t.val = 123;\n");\n\nvar plan = sqlBuilder.GetPlan();\n')),(0,r.kt)("p",null,"Replace all values with that are between { } with your own table names in your SQL Server."),(0,r.kt)("h2",{id:"setting-up-a-read-and-write-factory"},"Setting up a read and write factory"),(0,r.kt)("p",null,"Each stream requires a factory that provides it with source and sink operators. These provide the actual implementation when talking with other sources."),(0,r.kt)("p",null,"Some examples of sinks and sources are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"MS SQL"),(0,r.kt)("li",{parentName:"ul"},"Kafka"),(0,r.kt)("li",{parentName:"ul"},"Postgres")),(0,r.kt)("p",null,"This example will add a connection for SQL Server:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},'var factory = new ReadWriteFactory();\n// Wildcard that all sources should use the following configuration\nfactory.AddSqlServerSource("*", () => "Server={your server};Database={your database};Trusted_Connection=True;");\n// Wildcard that all sinks will use this configuration\nfactory.AddSqlServerSink("*", () => "Server={your server};Database={your database};Trusted_Connection=True;");\n')),(0,r.kt)("h2",{id:"running-the-stream"},"Running the stream"),(0,r.kt)("p",null,"Finally to run the stream we add the following code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},"builder.Services.AddFlowtideStream(b =>\n{\n    b.AddPlan(plan)\n    .AddReadWriteFactory(factory)\n    .WithStateOptions(() => new StateManagerOptions()\n    {\n        // This is non persistent storage, use FasterKV persistence storage instead if you want persistent storage\n        PersistentStorage = new FileCachePersistentStorage(new FlowtideDotNet.Storage.FileCacheOptions()\n        {\n        })\n    });\n});\n")),(0,r.kt)("h3",{id:"persistent-storage"},"Persistent storage"),(0,r.kt)("p",null,"The previous example does not use persistent storage, to use persistent storage, you can instead use the FasterKV storage:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},'PersistentStorage = new FasterKvPersistentStorage(new FasterKVSettings<long, SpanByte>()\n{\n    RemoveOutdatedCheckpoints = true,\n    MemorySize = 1024 * 1024 * 128,\n    PageSize = 1024 * 1024 * 16,\n    LogDevice = Devices.CreateLogDevice("./data/persistent/log"),\n    CheckpointDir = "./data/checkpoints"\n})\n')),(0,r.kt)("p",null,"The stream will then be persistent between checkpoints."),(0,r.kt)("h2",{id:"adding-the-ui"},"Adding the UI"),(0,r.kt)("p",null,'If you want to add the UI to visualize the progress of the stream, add the following code after "var app = builder.Build();".'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'app.UseFlowtideUI("/stream");\n')),(0,r.kt)("h2",{id:"full-example"},"Full example"),(0,r.kt)("p",null,"Here is the full code example to get started:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},'\nvar builder = WebApplication.CreateBuilder(args);\n\nvar sqlBuilder = new SqlPlanBuilder();\n\nsqlBuilder.Sql(@"\nCREATE TABLE {sqlserver database name}.{schema name}.{tablename} (\n  val any\n);\n\nCREATE TABLE {sqlserver database name}.{schema name}.{othertablename} (\n  val any\n);\n\nINSERT INTO {sqlserver database name}.{schema name}.{destinationname}\nSELECT t.val FROM {sqlserver database name}.{schema name}.{tablename} t\nLEFT JOIN {sqlserver database name}.{schema name}.{othertablename} o\nON t.val = o.val\nWHERE t.val = 123;\n");\n\nvar plan = sqlBuilder.GetPlan();\n\nvar factory = new ReadWriteFactory();\n// Wildcard that all sources should use the following configuration\nfactory.AddSqlServerSource("*", () => "Server={your server};Database={your database};Trusted_Connection=True;");\n// Wildcard that all sinks will use this configuration\nfactory.AddSqlServerSink("*", () => "Server={your server};Database={your database};Trusted_Connection=True;");\n\nbuilder.Services.AddFlowtideStream(b =>\n{\n    b.AddPlan(plan)\n    .AddReadWriteFactory(factory)\n    .WithStateOptions(() => new StateManagerOptions()\n    {\n        // This is non persistent storage, use FasterKV persistence storage instead if you want persistent storage\n        PersistentStorage = new FileCachePersistentStorage(new FlowtideDotNet.Storage.FileCacheOptions()\n        {\n        })\n    });\n});\n\nvar app = builder.Build();\napp.UseFlowtideUI("/stream");\n\napp.Run();\n')))}p.isMDXComponent=!0}}]);