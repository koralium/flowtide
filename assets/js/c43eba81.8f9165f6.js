"use strict";(self.webpackChunkflowtide=self.webpackChunkflowtide||[]).push([[400],{3885:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>r,contentTitle:()=>o,default:()=>g,frontMatter:()=>a,metadata:()=>I,toc:()=>l});var n=t(4848),s=t(8453);const a={sidebar_position:2},o="State Persistence",I={id:"statepersistence",title:"State Persistence",description:"The settings in this page does not cover when setting up Flowtide using Dependency Injection.",source:"@site/docs/statepersistence.md",sourceDirName:".",slug:"/statepersistence",permalink:"/flowtide/docs/statepersistence",draft:!1,unlisted:!1,editUrl:"https://github.com/koralium/flowtide/tree/main/docs/docs/statepersistence.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Getting started",permalink:"/flowtide/docs/intro"},next:{title:"Parallelism",permalink:"/flowtide/docs/parallelism"}},r={},l=[{value:"FasterKV storage",id:"fasterkv-storage",level:2},{value:"Useful configuration options",id:"useful-configuration-options",level:3},{value:"Storing to disk",id:"storing-to-disk",level:3},{value:"Storing to Azure Storage",id:"storing-to-azure-storage",level:3},{value:"Temporary file cache storage",id:"temporary-file-cache-storage",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Storage solution",id:"storage-solution",level:2},{value:"Compression",id:"compression",level:2}];function c(e){const i={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.header,{children:(0,n.jsx)(i.h1,{id:"state-persistence",children:"State Persistence"})}),"\n",(0,n.jsx)(i.admonition,{type:"info",children:(0,n.jsxs)(i.p,{children:["The settings in this page does not cover when setting up Flowtide using Dependency Injection.\nThese settings can be applied when setting up a stream using ",(0,n.jsx)(i.em,{children:"FlowtideBuilder"})," class."]})}),"\n",(0,n.jsx)(i.p,{children:"All Flowtide streams require a persistent storage solution to function.\nIt is responsible for persisting the data at checkpoint intervals to ensure the stream can continue to operate in case of a failure."}),"\n",(0,n.jsx)(i.p,{children:"At this time there are two different implementations for the persistent storage solution, FasterKV backed, and a temporary file cache solution."}),"\n",(0,n.jsx)(i.h2,{id:"fasterkv-storage",children:"FasterKV storage"}),"\n",(0,n.jsx)(i.p,{children:"FasterKV is persistent key value store built by Microsoft. It is the only storage solution available for Flowtide that will persist data between runs.\nFasterKV is highly configurable, and how you configure it will affect the performance of your stream."}),"\n",(0,n.jsx)(i.p,{children:"To configure your stream to use FasterKV storage, add the following to the builder:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-csharp",children:"builder\n.WithStateOptions(() => new StateManagerOptions()\n{\n    PersistentStorage = new FasterKvPersistentStorage(new FasterKVSettings<long, SpanByte>()\n    {\n        // Set the fasterKV configuration here\n        ...\n    })\n});\n"})}),"\n",(0,n.jsx)(i.h3,{id:"useful-configuration-options",children:"Useful configuration options"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Property"}),(0,n.jsx)(i.th,{children:"Description"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"LogDevice"}),(0,n.jsx)(i.td,{children:"The log device that will write to storage"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"MemorySize"}),(0,n.jsx)(i.td,{children:"How much memory FasterKV can use"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"PageSize"}),(0,n.jsx)(i.td,{children:"how large a page is"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"CheckpointDir"}),(0,n.jsx)(i.td,{children:"Where checkpoints should be stored"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"CheckpointManager"}),(0,n.jsx)(i.td,{children:"Checkpoint manager, useful if using Azure Storage."})]})]})]}),"\n",(0,n.jsx)(i.h3,{id:"storing-to-disk",children:"Storing to disk"}),"\n",(0,n.jsx)(i.p,{children:"This is an example of a configuration to store to a disk."}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-csharp",children:'var baseDirectory = "/persistence/"\nbuilder.WithStateOptions(() => new StateManagerOptions()\n{\n    // Set cache page count to reduce the memory usage\n    CachePageCount = 10000,\n    PersistentStorage = new FasterKvPersistentStorage(new FasterKVSettings<long, SpanByte>()\n    {\n        // Checkpoint directory\n        CheckpointDir = $"{baseDirectory}/checkpoints",\n        // A local file log device\n        LogDevice = Devices.CreateLogDevice($"{baseDirectory}/log"),\n        // Redice memory usage of fasterKV, to limit memory usage\n        MemorySize =  1024L * 1024L * 64,\n        // Page size\n        PageSize = 1024 * 1024 * 16,\n    }),\n    TemporaryStorageOptions = new FileCacheOptions()\n    {\n        // Path where the temporary cache is stored\n        DirectoryPath = $"./temp"\n    }\n})\n'})}),"\n",(0,n.jsx)(i.h3,{id:"storing-to-azure-storage",children:"Storing to Azure Storage"}),"\n",(0,n.jsx)(i.p,{children:"Storing the data in an Azure Storage requires a bit more configuration, especially a checkpoint manager."}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-csharp",children:'// Create azure storage device\nvar log = new AzureStorageDevice(STORAGE_STRING, BASE_CONTAINER, "", "hlog.log");\n\n// Create azure storage backed checkpoint manager\nvar checkpointManager = new DeviceLogCommitCheckpointManager(\n                new AzureStorageNamedDeviceFactory(STORAGE_STRING),\n                new DefaultCheckpointNamingScheme($"{BASE_CONTAINER}/checkpoints/"));\n\nbuilder.WithStateOptions(() => new StateManagerOptions()\n{\n    // Set cache page count to reduce the memory usage\n    CachePageCount = 10000,\n    PersistentStorage = new FasterKvPersistentStorage(new FasterKVSettings<long, SpanByte>()\n    {\n        CheckpointManager = checkpointManager,\n        LogDevice = log,\n        // Redice memory usage of fasterKV, to limit memory usage\n        MemorySize =  1024L * 1024L * 64,\n        // Page size\n        PageSize = 1024 * 1024 * 16,\n    }),\n    TemporaryStorageOptions = new FileCacheOptions()\n    {\n        // Path where the temporary cache is stored\n        DirectoryPath = $"./temp"\n    }\n})\n'})}),"\n",(0,n.jsx)(i.h2,{id:"temporary-file-cache-storage",children:"Temporary file cache storage"}),"\n",(0,n.jsx)(i.p,{children:"This storage solution is useful when developing or running unit tests on a stream.\nAll data will be cleared between each run, but it will be persisted to local disk to reduce RAM usage and allow you to run streams with alot of data."}),"\n",(0,n.jsx)(i.p,{children:"The implementation of this is using the same solution as the intermediate file cache solution where modified pages are stored between checkpoints."}),"\n",(0,n.jsx)(i.p,{children:"To configure your stream to use this storage solution, add the following to the stream builder:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-csharp",children:'builder\n.WithStateOptions(() => new StateManagerOptions()\n{\n    // This is non persistent storage, use FasterKV persistence storage instead if you want persistent storage\n    PersistentStorage = new FileCachePersistentStorage(new FlowtideDotNet.Storage.FileCacheOptions()\n    {\n        DirectoryPath = "./tmp"\n    })\n});\n'})}),"\n",(0,n.jsx)(i.h3,{id:"configuration",children:"Configuration"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Property"}),(0,n.jsx)(i.th,{children:"Default value"}),(0,n.jsx)(i.th,{children:"Description"})]})}),(0,n.jsx)(i.tbody,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"DirectoryPath"}),(0,n.jsx)(i.td,{children:"./data/tempFiles"}),(0,n.jsx)(i.td,{children:"Path where the files will be stored"})]})})]}),"\n",(0,n.jsx)(i.h2,{id:"storage-solution",children:"Storage solution"}),"\n",(0,n.jsx)(i.p,{children:"The stream storage is built on a three tier architecture, there is the in memory cache, the local disk modified page cache, and the persistent data."}),"\n",(0,n.jsx)(i.p,{children:"A data page is fetched using the following logic:"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjAvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMtU1ZHLTIwMDEwOTA0L0RURC9zdmcxMC5kdGQiPgo8c3ZnIHZpZXdCb3g9IjAgMCA5MDYgMjgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOmlua3NwYWNlPSJodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy9uYW1lc3BhY2VzL2lua3NjYXBlIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgPGRlZnMgaWQ9ImRlZnNfYmxvY2siPgogICAgPGZpbHRlciBoZWlnaHQ9IjEuNTA0IiBpZD0iZmlsdGVyX2JsdXIiIGlua3NwYWNlOmNvbGxlY3Q9ImFsd2F5cyIgd2lkdGg9IjEuMTU3NSIgeD0iLTAuMDc4NzUiIHk9Ii0wLjI1MiI+CiAgICAgIDxmZUdhdXNzaWFuQmx1ciBpZD0iZmVHYXVzc2lhbkJsdXIzNzgwIiBpbmtzcGFjZTpjb2xsZWN0PSJhbHdheXMiIHN0ZERldmlhdGlvbj0iNC4yIiAvPgogICAgPC9maWx0ZXI+CiAgPC9kZWZzPgogIDx0aXRsZT5ibG9ja2RpYWc8L3RpdGxlPgogIDxkZXNjPiAgYmxvY2tkaWFnIHsKICAgIElzSW5NZW1vcnkgW2xhYmVsID0gIlBhZ2UgaXMgaW4gbWVtb3J5Iiwgc2hhcGUgPSBkaWFtb25kLCB3aWR0aCA9IDIwMF0KICAgIEZldGNoRnJvbU1lbW9yeSBbbGFiZWwgPSAiRmV0Y2ggZnJvbSBtZW1vcnkiXQogICAgSXNJbk1vZGlmaWVkQ2FjaGUgW2xhYmVsID0gIlBhZ2UgaW4gbW9kaWZpZWQgY2FjaGUiLCBzaGFwZSA9IGRpYW1vbmQsIHdpZHRoID0gMjUwXQogICAgRmV0Y2hGcm9tTW9kaWZpZWRDYWNoZSBbbGFiZWwgPSAiRmV0Y2ggZnJvbSBtb2RpZmllZCBjYWNoZSIsIHdpZHRoID0gMjAwXQogICAgRmV0Y2hGcm9tcGVyc2lzdGVudFN0b3JhZ2UgW2xhYmVsID0gIkZldGNoIGZyb20gcGVyc2lzdGVudCBzdG9yYWdlIiwgd2lkdGggPSAyMDBdCiAgICBJc0luTWVtb3J5IC0mZ3Q7IEZldGNoRnJvbU1lbW9yeSBbbGFiZWwgPSAiWWVzIl0KICAgIElzSW5NZW1vcnkgLSZndDsgSXNJbk1vZGlmaWVkQ2FjaGUgW2xhYmVsID0gIk5vIl0KICAgIElzSW5Nb2RpZmllZENhY2hlIC0mZ3Q7IEZldGNoRnJvbU1vZGlmaWVkQ2FjaGUgW2xhYmVsID0gIlllcyJdCiAgICBJc0luTW9kaWZpZWRDYWNoZSAtJmd0OyBGZXRjaEZyb21wZXJzaXN0ZW50U3RvcmFnZSBbbGFiZWwgPSAiTm8iXQogIH08L2Rlc2M+CiAgPHBvbHlnb24gZmlsbD0icmdiKDAsMCwwKSIgcG9pbnRzPSIxNjcsMzggMjc1LDY2IDE2Nyw5NCA1OSw2NiAxNjcsMzgiIHN0cm9rZT0icmdiKDAsMCwwKSIgc3R5bGU9ImZpbHRlcjp1cmwoI2ZpbHRlcl9ibHVyKTtvcGFjaXR5OjAuNztmaWxsLW9wYWNpdHk6MSIgLz4KICA8cmVjdCBmaWxsPSJyZ2IoMCwwLDApIiBoZWlnaHQ9IjQwIiBzdHJva2U9InJnYigwLDAsMCkiIHN0eWxlPSJmaWx0ZXI6dXJsKCNmaWx0ZXJfYmx1cik7b3BhY2l0eTowLjc7ZmlsbC1vcGFjaXR5OjEiIHdpZHRoPSIxMjgiIHg9IjM5MiIgeT0iNDYiIC8+CiAgPHBvbHlnb24gZmlsbD0icmdiKDAsMCwwKSIgcG9pbnRzPSI0NTYsMTE4IDU4OSwxNDYgNDU2LDE3NCAzMjMsMTQ2IDQ1NiwxMTgiIHN0cm9rZT0icmdiKDAsMCwwKSIgc3R5bGU9ImZpbHRlcjp1cmwoI2ZpbHRlcl9ibHVyKTtvcGFjaXR5OjAuNztmaWxsLW9wYWNpdHk6MSIgLz4KICA8cmVjdCBmaWxsPSJyZ2IoMCwwLDApIiBoZWlnaHQ9IjQwIiBzdHJva2U9InJnYigwLDAsMCkiIHN0eWxlPSJmaWx0ZXI6dXJsKCNmaWx0ZXJfYmx1cik7b3BhY2l0eTowLjc7ZmlsbC1vcGFjaXR5OjEiIHdpZHRoPSIyMDAiIHg9IjY0NSIgeT0iMTI2IiAvPgogIDxyZWN0IGZpbGw9InJnYigwLDAsMCkiIGhlaWdodD0iNDAiIHN0cm9rZT0icmdiKDAsMCwwKSIgc3R5bGU9ImZpbHRlcjp1cmwoI2ZpbHRlcl9ibHVyKTtvcGFjaXR5OjAuNztmaWxsLW9wYWNpdHk6MSIgd2lkdGg9IjIwMCIgeD0iNjQ1IiB5PSIyMDYiIC8+CiAgPHBvbHlnb24gZmlsbD0icmdiKDI1NSwyNTUsMjU1KSIgcG9pbnRzPSIxNjQsMzIgMjcyLDYwIDE2NCw4OCA1Niw2MCAxNjQsMzIiIHN0cm9rZT0icmdiKDAsMCwwKSIgLz4KICA8dGV4dCBmaWxsPSJyZ2IoMCwwLDApIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMSIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXdlaWdodD0ibm9ybWFsIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB0ZXh0TGVuZ3RoPSIxMDQiIHg9IjE2NC4wIiB5PSI2NyI+UGFnZSBpcyBpbiBtZW1vcnk8L3RleHQ+CiAgPHJlY3QgZmlsbD0icmdiKDI1NSwyNTUsMjU1KSIgaGVpZ2h0PSI0MCIgc3Ryb2tlPSJyZ2IoMCwwLDApIiB3aWR0aD0iMTI4IiB4PSIzODkiIHk9IjQwIiAvPgogIDx0ZXh0IGZpbGw9InJnYigwLDAsMCkiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtYW5jaG9yPSJtaWRkbGUiIHRleHRMZW5ndGg9IjExMSIgeD0iNDUzLjUiIHk9IjY3Ij5GZXRjaCBmcm9tIG1lbW9yeTwvdGV4dD4KICA8cG9seWdvbiBmaWxsPSJyZ2IoMjU1LDI1NSwyNTUpIiBwb2ludHM9IjQ1MywxMTIgNTg2LDE0MCA0NTMsMTY4IDMyMCwxNDAgNDUzLDExMiIgc3Ryb2tlPSJyZ2IoMCwwLDApIiAvPgogIDx0ZXh0IGZpbGw9InJnYigwLDAsMCkiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtYW5jaG9yPSJtaWRkbGUiIHRleHRMZW5ndGg9IjEyOSIgeD0iNDUyLjUiIHk9IjE0NyI+UGFnZSBpbiBtb2RpZmllZCBjYWNoZTwvdGV4dD4KICA8cmVjdCBmaWxsPSJyZ2IoMjU1LDI1NSwyNTUpIiBoZWlnaHQ9IjQwIiBzdHJva2U9InJnYigwLDAsMCkiIHdpZHRoPSIyMDAiIHg9IjY0MiIgeT0iMTIwIiAvPgogIDx0ZXh0IGZpbGw9InJnYigwLDAsMCkiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtYW5jaG9yPSJtaWRkbGUiIHRleHRMZW5ndGg9IjE0OSIgeD0iNzQyLjUiIHk9IjE0NiI+RmV0Y2ggZnJvbSBtb2RpZmllZCBjYWNoZTwvdGV4dD4KICA8cmVjdCBmaWxsPSJyZ2IoMjU1LDI1NSwyNTUpIiBoZWlnaHQ9IjQwIiBzdHJva2U9InJnYigwLDAsMCkiIHdpZHRoPSIyMDAiIHg9IjY0MiIgeT0iMjAwIiAvPgogIDx0ZXh0IGZpbGw9InJnYigwLDAsMCkiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtYW5jaG9yPSJtaWRkbGUiIHRleHRMZW5ndGg9IjE2NiIgeD0iNzQyLjAiIHk9IjIyNyI+RmV0Y2ggZnJvbSBwZXJzaXN0ZW50IHN0b3JhZ2U8L3RleHQ+CiAgPHBhdGggZD0iTSAyNzIgNjAgTCAzODEgNjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0icmdiKDAsMCwwKSIgLz4KICA8cG9seWdvbiBmaWxsPSJyZ2IoMCwwLDApIiBwb2ludHM9IjM4OCw2MCAzODEsNTYgMzgxLDY0IDM4OCw2MCIgc3Ryb2tlPSJyZ2IoMCwwLDApIiAvPgogIDxwYXRoIGQ9Ik0gMjcyIDYwIEwgMjk2IDYwIiBmaWxsPSJub25lIiBzdHJva2U9InJnYigwLDAsMCkiIC8+CiAgPHBhdGggZD0iTSAyOTYgNjAgTCAyOTYgMTQwIiBmaWxsPSJub25lIiBzdHJva2U9InJnYigwLDAsMCkiIC8+CiAgPHBhdGggZD0iTSAyOTYgMTQwIEwgMzEyIDE0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZ2IoMCwwLDApIiAvPgogIDxwb2x5Z29uIGZpbGw9InJnYigwLDAsMCkiIHBvaW50cz0iMzE5LDE0MCAzMTIsMTM2IDMxMiwxNDQgMzE5LDE0MCIgc3Ryb2tlPSJyZ2IoMCwwLDApIiAvPgogIDxwYXRoIGQ9Ik0gNTg2IDE0MCBMIDYzNCAxNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0icmdiKDAsMCwwKSIgLz4KICA8cG9seWdvbiBmaWxsPSJyZ2IoMCwwLDApIiBwb2ludHM9IjY0MSwxNDAgNjM0LDEzNiA2MzQsMTQ0IDY0MSwxNDAiIHN0cm9rZT0icmdiKDAsMCwwKSIgLz4KICA8cGF0aCBkPSJNIDU4NiAxNDAgTCA2MTAgMTQwIiBmaWxsPSJub25lIiBzdHJva2U9InJnYigwLDAsMCkiIC8+CiAgPHBhdGggZD0iTSA2MTAgMTQwIEwgNjEwIDIyMCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZ2IoMCwwLDApIiAvPgogIDxwYXRoIGQ9Ik0gNjEwIDIyMCBMIDYzNCAyMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0icmdiKDAsMCwwKSIgLz4KICA8cG9seWdvbiBmaWxsPSJyZ2IoMCwwLDApIiBwb2ludHM9IjY0MSwyMjAgNjM0LDIxNiA2MzQsMjI0IDY0MSwyMjAiIHN0cm9rZT0icmdiKDAsMCwwKSIgLz4KICA8cmVjdCBmaWxsPSJ3aGl0ZSIgaGVpZ2h0PSIxNSIgc3Ryb2tlPSJyZ2IoMCwwLDApIiB3aWR0aD0iMzYiIHg9IjI3OCIgeT0iMzgiIC8+CiAgPHRleHQgZmlsbD0icmdiKDAsMCwwKSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgdGV4dExlbmd0aD0iMjAiIHg9IjI5Ni4wIiB5PSI1MSI+WWVzPC90ZXh0PgogIDxyZWN0IGZpbGw9IndoaXRlIiBoZWlnaHQ9IjE1IiBzdHJva2U9InJnYigwLDAsMCkiIHdpZHRoPSIzMyIgeD0iMjgwIiB5PSIxMTgiIC8+CiAgPHRleHQgZmlsbD0icmdiKDAsMCwwKSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgdGV4dExlbmd0aD0iMTciIHg9IjI5Ni41IiB5PSIxMzEiPk5vPC90ZXh0PgogIDxyZWN0IGZpbGw9IndoaXRlIiBoZWlnaHQ9IjE1IiBzdHJva2U9InJnYigwLDAsMCkiIHdpZHRoPSIzNiIgeD0iNTkyIiB5PSIxMTgiIC8+CiAgPHRleHQgZmlsbD0icmdiKDAsMCwwKSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgdGV4dExlbmd0aD0iMjAiIHg9IjYxMC4wIiB5PSIxMzEiPlllczwvdGV4dD4KICA8cmVjdCBmaWxsPSJ3aGl0ZSIgaGVpZ2h0PSIxNSIgc3Ryb2tlPSJyZ2IoMCwwLDApIiB3aWR0aD0iMzMiIHg9IjU5NCIgeT0iMTk4IiAvPgogIDx0ZXh0IGZpbGw9InJnYigwLDAsMCkiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtYW5jaG9yPSJtaWRkbGUiIHRleHRMZW5ndGg9IjE3IiB4PSI2MTAuNSIgeT0iMjExIj5ObzwvdGV4dD4KPC9zdmc+Cg==",alt:"blockdiag"})}),"\n",(0,n.jsx)(i.h2,{id:"compression",children:"Compression"}),"\n",(0,n.jsx)(i.p,{children:"It is possible to compress pages in the state.\nThis is done by providing two functions to state serialize options, a compress function and a decompress function."}),"\n",(0,n.jsx)(i.p,{children:"Example using ZLib compression:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-csharp",children:"builder.WithStateOptions(() => new StateManagerOptions()\n{\n    ...\n    SerializeOptions = new StateSerializeOptions()\n    {\n        CompressFunc = (stream) =>\n        {\n            return new System.IO.Compression.ZLibStream(stream, CompressionMode.Compress);\n        },\n        DecompressFunc = (stream) =>\n        {\n            return new System.IO.Compression.ZLibStream(stream, CompressionMode.Decompress);\n        }\n    }\n})\n"})})]})}function g(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,i,t)=>{t.d(i,{R:()=>o,x:()=>I});var n=t(6540);const s={},a=n.createContext(s);function o(e){const i=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function I(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(a.Provider,{value:i},e.children)}}}]);